# 品类匹配统一配置文件示例
# 复制为 app_config.yaml 后按需修改；未填项使用下方默认值。

# 大模型：API Key 可留空，使用 api_key_encrypted 或环境变量 OPENAI_API_KEY
# api_key / api_key_encrypted 支持 ${VAR_NAME} 占位，会替换为环境变量值，例如 api_key: "${OPENAI_API_KEY}"
llm:
  api_key: ""
  api_key_encrypted: ""
  base_url: "https://dashscope.aliyuncs.com/compatible-mode/v1"
  model: "qwen-plus"

# MCP 服务器：大模型调用工具（如搜索）时使用
mcp:
  servers:
    - name: "示例-stdio"
      transport: "stdio"
      command: "npx"
      args: ["-y", "@modelcontextprotocol/server-echo"]
      env: {}
      cwd: null
    # - name: "示例-http"
    #   transport: "streamable-http"
    #   url: "https://your-mcp-server.example.com/mcp"

# 匹配：相似度阈值、LLM 回退、并发数、分块写入
matching:
  similarity_threshold: 0
  llm_fallback_threshold: 0.9
  batch_max_workers: 8
  batch_save_chunk_size: 0   # 每处理多少条就追加写入一次，0 表示不分块；设为 2000 等可降低内存并保留部分结果
  llm_unmatched_marker: "未匹配到结果"
  llm_unmatched_aliases: ["未匹配到结果", "未匹配到"]

# 应用：规则/品牌 Excel 文件名、输入文件名忽略
app:
  rules_filename: "原子品类关键词.xlsx"
  verified_filename: "校验过的品牌对应原子品类.xlsx"
  input_stem_ignore: "新建文本文档"

# 日志：按大小切割时的单文件上限与保留备份数
logging:
  log_rotate_max_bytes: 10485760   # 单文件超过该字节数时切割，默认 10MB
  log_rotate_backup_count: 5      # 切割后保留的历史文件个数，0 表示不限制

# 向量模型：BGE 模型与相似度权重
embedding:
  bge_model_id: "BAAI/bge-small-zh-v1.5"
  bge_weight: 0.5
  fill_embedding_chunk: 16000
  encode_batch_size: 512

# LLM 客户端：单次 token、日志摘要长度
llm_client:
  max_tokens: 768
  log_input_summary_len: 80
  log_result_summary_len: 120

# 提示词：参考关键词条数与字数
prompt:
  max_keyword_examples: 10
  max_keyword_hint_chars: 120
